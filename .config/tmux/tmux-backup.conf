##### ---------------------------------------------------------
#####  macOS + Ghostty + Fish + Truecolor Optimized tmux.conf
##### ---------------------------------------------------------

# --- TERMINAL SETTINGS (Ghostty optimized) -------------------

# Use Ghostty's 24-bit color terminal type
set -g default-terminal "ghostty"
set -as terminal-overrides ",ghostty:RGB"

# Enable focus reporting for modern terminals
set -g focus-events on

# Disable tmux default delay
set -g escape-time 10


# --- SHELL SETTINGS (Fish) -----------------------------------

set -g default-shell /opt/homebrew/bin/fish
set -g default-command /opt/homebrew/bin/fish


# --- GENERAL OPTIONS -----------------------------------------

set -g mouse on
set -g history-limit 10000

set -g renumber-windows on
set -g automatic-rename on
set -g set-titles on

set -g exit-empty off
set -g exit-unattached off

# History file (macOS-safe)
set -g history-file "$HOME/.local/share/tmux/history"


# --- PREFIX ---------------------------------------------------

# Switch prefix from Ctrl+b → Ctrl+a
unbind C-b
set -g prefix C-a
bind-key C-a send-prefix


# --- CLIPBOARD (macOS) ---------------------------------------

set -g set-clipboard on
set -g copy-command "pbcopy"

# Vi-mode copy bindings
set -g mode-keys vi

bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"


# --- STYLING (Compatible with macOS) --------------------------

set -g clock-mode-style 24

# Powerline-style status bar with NerdFonts
set -g status-position bottom
set -g status-justify left
set -g status-left-length 20

# Colors (optimized for Ghostty color palette)
set -g status-style "bg=#22252C,fg=#ABB2BF"

set -g status-left \
"#[bg=#61AFEF,fg=#000000] #S #[bg=#22252C,fg=#61AFEF]"

set -g status-right \
"#[bg=#22252C,fg=#BE5046]#[bg=#BE5046,fg=#000000] #H \
#[bg=#D19A66,fg=#BE5046]#[bg=#D19A66,fg=#000000] #(date +%Y-%m-%d) \
#[bg=#E5C07B,fg=#D19A66]#[bg=#E5C07B,fg=#000000] #(date +%H:%M)"

set -g pane-border-status top
set -g pane-border-style "bg=#282C34"
set -g pane-active-border-style "fg=#89CA78,bold"


# --- WINDOW & PANE BINDINGS ----------------------------------

bind \\ split-window -h -c "#{pane_current_path}"
bind - split-window  -v -c "#{pane_current_path}"

bind | split-window -f -h -c "#{pane_current_path}"
bind _ split-window -f -v -c "#{pane_current_path}"

bind c new-window -c "#{pane_current_path}"

# Swap windows
bind -r H swap-window -d -t -1
bind -r L swap-window -d -t +1

# Quick new session
bind S command-prompt -p "New Session:" \
"new-session -c '#{pane_current_path}' -A -s '%%'"


# --- PLUGINS -------------------------------------------------

set-environment -g TMUX_PLUGIN_MANAGER_PATH "$HOME/.tmux/plugins"

set -g @plugin "tmux-plugins/tpm"
set -g @plugin "tmux-plugins/tmux-resurrect"
set -g @plugin "tmux-plugins/tmux-open"

# Restore Neovim sessions properly
set -g @resurrect-strategy-nvim "session"
set -g @resurrect-strategy-vim  "session"

# DuckDuckGo search key
set -g @open-S "https://www.duckduckgo.com/"

# TPM auto-install
if-shell 'test ! -d "$HOME/.tmux/plugins/tpm"' \
  'run "git clone https://github.com/tmux-plugins/tpm $HOME/.tmux/plugins/tpm"'

# Initialize TPM
run "$HOME/.tmux/plugins/tpm/tpm"


# --- RELOAD --------------------------------------------------

bind r source-file ~/.tmux.conf \; display "Reloaded!"

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-mem'
set -g @plugin 'tmux-plugins/tmux-net-speed'

